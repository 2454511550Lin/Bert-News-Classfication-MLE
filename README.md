# Bert Transfer Learning for News Classification

## Dataset

[MIcrosoft News Dataset (MIND)](https://msnews.github.io/) is a large-scale dataset for news recommendation research.
MIND contains about 160k English news articles and about 15 million impression logs generated by 1 million users.
Since the MIND dataset is highly unbalanced, this project randomly sampled 800 pieces for every 14 categories from training data and 800 pieces of news for every 14 pieces of news from testing data.
Therefore, there are 14 x 800 training data and 14 x 800 testing data. The total data samples are 22400 pieces of news.

## Method

### 1. Generate “News Vector” by BERT

For each of the training/testing data, this project used Bidirectional Encoder Representations from Transformers (BERT) to generate a real value “news vector” to represent them.
The procedures are shown below:
- For each piece of news, input the title and abstract to the BERT model as a sequence of two sentences.
- BERT will split each input word into subwords, and generate the sequential embedding vectors for each subword.
BERT has 12 layers of output, this project only uses the output of the last layer to be the vectors.
- Calculate the “news vector”(or sentence vector) by averaging all the subwords’ vectors in the title and abstract.

### 2. Maximum Likelihood Estimation of Gaussian Parameters

Assume that the news of each category is distributed as a Gaussian parameter. Using the training data, we are able to calculate the empirical mean and covariance for each category.
Then when doing the prediction for one piece of news, we can plug its "news vector" into every category's likelihood function.
In the end, we simply output the category corresponding to the maximum likelihood.

To make sure the covariance matrices are not ill-conditioned, the following three ways have been used to regularize the covariance matrix:
- a) Adding an identity matrix
- b) Ledoit-Wolf
- c) Graphical LASSO

## Files

**generate_sen_vec_tf2.ipynb**: Generate the "news vectors" for training and testing data

**MLE_Gau.ipynb**: Predict using MLE of Guassian 
